# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD Pipeline

## üìä –û–±–∑–æ—Ä –ø–∞–π–ø–ª–∞–π–Ω–∞
[![Django CI/CD with Poetry](https://github.com/Anton742-Tu/HabitFlow-API/actions/workflows/ci.yml/badge.svg)](https://github.com/Anton742-Tu/HabitFlow-API/actions/workflows/ci.yml)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞** (black, isort, flake8)
2. **–ó–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤** (89/93 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç, 4 –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω—ã –≤ CI)
3. **–°–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–æ–≤** –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ GitHub Container Registry
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è** –Ω–∞ production —Å–µ—Ä–≤–µ—Ä
5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** –æ —Å—Ç–∞—Ç—É—Å–µ —Å–±–æ—Ä–∫–∏

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –æ–ø–∏—Å–∞–Ω –≤ `.github/workflows/ci.yml`

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∂–æ–±—ã:
- **code-quality-windows** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞
- **test-linux** - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å PostgreSQL –∏ Redis
- **build-docker** - —Å–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–æ–≤
- **deploy** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–µ—Ç–∫–∏ `main`)
- **notify** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

## üì¶ Docker –æ–±—Ä–∞–∑—ã
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è:
- `ghcr.io/anton742-tu/habitflow-api:latest`
- `ghcr.io/anton742-tu/habitflow-api-nginx:latest`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Å–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
1. **–î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub**:
   - `SERVER_IP` - IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - `SSH_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - `SSH_PRIVATE_KEY` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á
   - `DEPLOY_DIR` - –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

2. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose
   sudo apt update
   sudo apt install docker.io docker-compose

   # –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
   sudo usermod -aG docker $USER
